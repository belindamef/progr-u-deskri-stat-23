---
fontsize: 8pt
bibliography: 10_Referenzen.bib
citation_package: natbib
output:
  beamer_presentation:
    keep_tex: true
    includes:
      in_header: 10_header.tex
---


```{r, include = F}
source("10_R_common.R")
```

# {.plain} 
\center
```{r, echo = FALSE, out.width = "20%"}
knitr::include_graphics("10_Abbildungen/pds_10_otto.png")
```

\vspace{2mm}

\huge
Programmierung und Deskriptive Statistik
\vspace{6mm}

\large
BSc Psychologie WiSe 2021/22

\vspace{6mm}
\large
Prof. Dr. Dirk Ostwald

# {.plain}
\vfill
\huge
\begin{center}
(10) Maße der Variabilität
\end{center}
\vfill

#
\small
\center
\footnotesize
\renewcommand{\arraystretch}{1.1}
\begin{tabular}{lll}
Datum        & Einheit                     & Thema					                     \\\hline
14.10.2021   & Einführung                  & (1)  Einführung 				             \\
21.10.2021   & R Grundlagen                & (2)  R und RStudio I           	         \\
28.10.2021   & R Grundlagen                & (2)  R und RStudio II                       \\
04.11.2021   & R Grundlagen                & (3)  Vektoren                               \\
11.11.2021   & R Grundlagen                & (4)  Matrizen                               \\
18.11.2021   & R Grundlagen                & (5)  Listen und Dataframes                  \\
25.11.2021   & Deskriptive Statistik       & (6)  Datenmanagement                         \\
02.12.2021   & Deskriptive Statistik       & (7)  Häufigkeitsverteilungen                \\
09.12.2021   & Deskriptive Statistik       & (8)  Verteilungsfunktionen und Quantile     \\
16.12.2021   & Deskriptive Statistik       & (9)  Maße der zentralen Tendenz             \\
             & \textcolor{gray}{Weihnachtspause}                                         
\\
\textbf{13.01.2022}
& \textbf{Deskriptive Statistik}
& \textbf{(10) Maße der Datenvariabilität}
\\
20.01.2022   & Inferenzstatistik           & (11) Anwendungsbeispiel                     \\
27.01.2022   & Inferenzstatistik           & (11) Anwendungsbeispiel                     \\\hline
25.02.2022   & Klausurtermin               &  G26 – H1, 9:00 - 10:00 Uhr                 \\
Jul 2022     & Klausurwiederholungstermin
\end{tabular}

# 
\large
\vfill
\setstretch{2.5}

Spannbreite

Stichprobenvarianz

Stichprobenstandardabweichung

Selbstkontrollfragen
\vfill

# 
\large
\vfill
\setstretch{2.5}

**Spannbreite**

Stichprobenvarianz

Stichprobenstandardabweichung

Selbstkontrollfragen
\vfill

# Spannbreite
\small
\begin{definition}[Spannbreite]
$x = (x_1,...,x_n)$ sei ein Datensatz. Dann ist die \textit{Spannbreite} von $x_1,...,x_n$ definiert als
\begin{equation}
S := \max(x_1,...,x_n) - \min(x_1,...,x_n).
\end{equation}
\end{definition}

# Spannbreite
\textcolor{darkblue}{Berechnen der Spannbreite mit} `range()`
\vspace{2mm}

\footnotesize
```{r}
# Einlesen des Beispieldatensatzes
fname   = file.path(getwd(), "10_Daten", "psychotherapie_datensatz.csv")
D       = read.table(fname, sep = ",")
fdir    = file.path(getwd(), "10_Abbildungen")

# Manuelle Spanntbreitenberechnung
x 	    = D$Pre.BDI 	   	            	# double Vektor der Pre-BDI Werte Werte 	
x_max 	= max(x)							# Maximum der TA1 Werte
x_min 	= min(x)							# Mininum der TA1 Werte
S 	    = x_max - x_min 					# Spannbreite
print(S)

# automatische Spannbreitenberechnung
MinMax	= range(x)							# "automatische" Berechnung von min(x), max(x)
S 		= MinMax[2] - MinMax[1]		        # Spannbreite
print(S)
```

# 
\large
\vfill
\setstretch{2.5}

Spannbreite

**Stichprobenvarianz**

Stichprobenstandardabweichung

Selbstkontrollfragen
\vfill

# Stichprobenvarianz
\footnotesize
\begin{definition}[Stichprobenvarianz, empirische Stichprobenvarianz]
\justifying
$x = (x_1,...,x_n)$ sei ein Datensatz. Die \textit{Stichprobenvarianz} von $x$ 
ist definiert als 
\begin{equation}
S^2 := \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2
\end{equation}
und die \textit{empirische Stichprobenvarianz} von $x$ ist definiert als
\begin{equation}
\tilde{S}^2 := \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2.
\end{equation}
\end{definition}

Bemerkungen

* $S^2$ ist ein unverzerrter Schätzer von $\mathbb{V}(X)$, $\tilde{S}^2$ ist ein verzerrter Schätzer $\mathbb{V}(X)$.
* Für $n \to \infty$ gilt $\frac{1}{n}\approx \frac{1}{n-1}$, $\tilde{S}^2$ ist ein asymptotisch unverzerrter Schätzer von  $\mathbb{V}(X)$.
* $\tilde{S}^2$ ist der ML Schätzer, $S^2$ ist der ReML Schätzer von $\sigma^2$ bei $X_1,...,X_n \sim N(\mu,\sigma^2)$.
* Es gelten
\begin{equation}
\tilde{S}^2 = \frac{n-1}{n}S^2, S^2 = \frac{n}{n-1}\tilde{S}^2 \mbox{ und } 0 \le \tilde{S}^2 \le S^2.
\end{equation}

# stichprobenvarianz

\textcolor{darkblue}{Berechnen der Stichprobenvarianz mit} `var()`
\vspace{2mm}
\footnotesize

```{r}
x 			= D$Pre.BDI 	   	            	# double Vektor der Pre-BDI Werte Werte											
n 			= length(x)							# Anzahl der Werte
S2 			= (1/(n-1))*sum((x - mean(x))^2)	# Stichprobenvarianz
print(S2)
S2 			= var(x)							# "automatische" Stichprobenvarianz
print(S2)
S2_tilde 	= (1/n)*sum((x - mean(x))^2)		# Empirische Stichprobenvarianz
print(S2_tilde)
S2_tilde 	= ((n-1)/n)*var(x)					# "automatische" empirische Stichprobenvarianz
print(S2_tilde)
```

# Stichprobenvarianz
\footnotesize
\begin{theorem}[Stichprobenvarianz bei linear-affinen Transformationen]
\justifying
\normalfont
$x = (x_1,...,x_n)$ sei ein Datensatz mit Stichprobenvarianz $S_x^2$ und
$y = (ax_1+b, ..., ax_n+b)$ sei der mit $a,b \in \mathbb{R}$ linear-affin
transformierte Datensatz mit Stichprobenvarianz $S_y^2$. Dann gilt
\begin{equation}
S^2_y = a^2 S^2_x.
\end{equation}
\end{theorem}
\tiny
\underline{Beweis}
\begin{align}
\begin{split}
S^2_y
:= \frac{1}{n-1}\sum_{i=1}^n (y_i - \bar{y})^2 
&  = \frac{1}{n-1}\sum_{i=1}^n (ax_i + b - (a\bar{x} + b))^2 \\
&  = \frac{1}{n-1}\sum_{i=1}^n (ax_i + b - a\bar{x} - b)^2 \\
&  = \frac{1}{n-1}\sum_{i=1}^n (a(x_i - \bar{x}))^2 \\
&  = \frac{1}{n-1}\sum_{i=1}^n a^2(x_i - \bar{x})^2 
   = a^2\frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2 
   = a^2S_x^2 \\
\end{split}
\end{align}




# Stichprobenvarianz
\textcolor{darkblue}{Stichprobenvarianz bei linear-affinen Transformationen}

\footnotesize
\vspace{2mm}
```{r}
# Stichprobenvarianz nach Transformation
x 		= D$Pre.BDI      	   	            	# double Vektor der Pre-BDI Werte Werte	
S2x		= var(x)								# Stichprobenvarianz von x_1,...,x_n
a		= 2 									# Multiplikationskonstante
b 		= 5 									# Additionskonstante
y 		= a*x + b							    # y_i = ax_i + b
S2y		= var(y)								# Stichprobenvarianz y_1,...,y_n
print(S2y)

# Stichprobenvarianz nach Theorem
S2y 	= a^2*S2x    							# Stichprobenvarianz y_1,...,y_n
print(S2y)
```

# Stichprobenvarianz
\setstretch{1.2}
\footnotesize
\begin{theorem}[Verschiebungssatz zur empirischen Stichprobenvarianz]
\justifying
\normalfont
$x = (x_1,...,x_n)$ sei ein Datensatz, $x^2 := (x_1^2, ..., x_n^2)$ sei sein
elementweises Quadrat und $\bar{x}$ und $\overline{x^2}$ seien die respektiven
Mittelwerte. Dann gilt
\begin{equation}
\tilde{S}^2 = \overline{x^2} - \bar{x}^2
\end{equation}
\end{theorem}
\underline{Beweis}
\begin{align}
\begin{split}
\tilde{S}^2
& := \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2 \\
&  = \frac{1}{n}\sum_{i=1}^n \left(x_i^2 - 2x_i \bar{x} +  \bar{x}^2\right) \\
&  =  \frac{1}{n}\sum_{i=1}^n x_i^2
	- 2  \bar{x}  \frac{1}{n}\sum_{i=1}^n x_i
	+ \frac{1}{n}\sum_{i=1}^n \bar{x}^2 \\
&  = \overline{x^2}
	- 2  \bar{x} \bar{x}
	+ \frac{1}{n}n\bar{x}^2 \\
&  = \overline{x^2}
	- 2  \bar{x}^2
	+ \bar{x}^2 \\
&  = \overline{x^2} - \bar{x}^2
\end{split}
\end{align}



# Stichprobenvarianz

\textcolor{darkblue}{Verschiebungssatz zur empirischen Stichprobenvarianz}

\footnotesize
\vspace{3mm}
```{r}
# Direkte Berechnung der empirischen Stichprobenvarianz
x 			= D$Pre.BDI      	   	            	# double Vektor der Pre-BDI Werte Werte
n           = length(x)                             # Anzahl Datenpunkte
x_bar 		= mean(x)								# Stichprobenmittel
S2_tilde 	= ((n-1)/n)*var(x)						# empirische Stichprobenvarianz
print(S2_tilde)

# Berechnung der empirischen Stichprobenvarianz mit Theorem
S2_tilde 	= mean(x^2) - (mean(x))^2				# \bar{x^2} - \bar{x}^2
print(S2_tilde)

# Das Theorem gilt nicht für die Stichprobenvarianz
S2 			= var(x)						        # S^2 \neq \bar{x^2} - \bar{x}^2						
print(S2)
```

# 
\large
\vfill
\setstretch{2.5}

Spannbreite

Stichprobenvarianz

**Stichprobenstandardabweichung**

Selbstkontrollfragen
\vfill

# Stichprobenstandardabweichung

\small
\begin{definition}[Stichprobenstandardabweichung, empirische]
$x = (x_1,...,x_n)$ sei ein Datensatz. Die \textit{Stichprobenstandardabweichung} 
von $x$ ist definiert als  
\begin{equation}
S := \sqrt{S^2}
\end{equation}
und die \textit{empirische Stichprobenstandardabweichung} von $x$ ist definiert als
\begin{equation}
\tilde{S} := \sqrt{\tilde{S}^2}.
\end{equation}
\end{definition}

Bemerkungen

* $S$ ist ein verzerrter Schätzer von $\mathbb{S}(X)$.
* $S^2$ misst Variabilität in quadrierten Einheiten, zum Beispiel Quadratmeter ($m^2)$.
* $S$ misst Variabilität in unquadrierten Einheiten, zum Beispiel Meter ($m$).
* Es gilt 
\begin{equation}
\tilde{S} = \sqrt{(n-1)/n}S.
\end{equation}



# Stichprobenstandardabweichung
\textcolor{darkblue}{Berechnung der Stichprobenstandardabweichung mit} `sd()`

\vspace{1mm}
\footnotesize
```{r}
# Manuelle Berechnung der Stichprobenstandardabweichung
x 		= D$Pre.BDI      	   	            	# double Vektor der Pre-BDI Werte Werte	
n 		= length(x)								# Anzahl der Werte
S 		= sqrt((1/(n-1))*sum((x - mean(x))^2))	# Standardabweichung
print(S)

# Automatische Berechnung der Stichprobenstandardabweichung
S 		= sd(x)								    # "automatische" Berechnung
print(S)

# Empirische Standardabweichung
S_tilde	= sqrt((1/(n))*sum((x - mean(x))^2))   # empirische Standardabweichung
print(S_tilde)
S_tilde	= sqrt((n-1)/n)*sd(x)				   # empirische Standardabweichung
print(S_tilde)
```
# Stichprobenstandardabweichung
\setstretch{1}
\footnotesize
\begin{theorem}[Stichprobenvarianz bei linear-affinen Transformationen]
\justifying
\normalfont
$x = (x_1,...,x_n)$ sei ein Datensatz mit Stichprobenstandardabweichung $S_x$ und
$y = (ax_1+b, ..., ax_n+b)$ sei der mit $a,b \in \mathbb{R}$ linear-affin
transformierte Datensatz mit Stichprobenstandardabweichung $S_y$. Dann gilt
\begin{equation}
S_y = |a| S_x.
\end{equation}
\end{theorem}
\tiny
\underline{Beweis}
\begin{align*}
\begin{split}
S_y
:= \left(\frac{1}{n-1}\sum_{i=1}^n (y_i - \bar{y})^2\right)^{1/2} 
&  = \left(\frac{1}{n-1}\sum_{i=1}^n \left(ax_i + b - (a\bar{x} + b)\right)^2\right)^{1/2} \\
&  = \left(\frac{1}{n-1}\sum_{i=1}^n \left(a(x_i - \bar{x})\right)^2\right)^{1/2}			\\
&  = \left(\frac{1}{n-1}\sum_{i=1}^n a^2(x_i - \bar{x})^2\right)^{1/2} \\
&  = \left(a^2\right)^{1/2}\left(\frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2\right)^{1/2}
\end{split}
\end{align*}
Also gilt $S_y = aS_x$, wenn $a \ge 0$ und $S_y = -aS_x$, wenn $a < 0$. Dies aber entspricht $S_y = |a|S_x$.


# Stichprobenstandardabweichung

\textcolor{darkblue}{Stichprobenstandardabweichung bei linear-affinen Transformationen}

\footnotesize
\setstretch{1}
```{r}
# a >= 0
x 	= D$Pre.BDI      	# double Vektor der Pre-BDI Werte Werte
Sx	= sd(x)				# Stichprobenvarianz von x
a	= 2 			    # Multiplikationskonstante
b 	= 5 				# Additionskonstante
y 	= a*x + b			# y_i = ax_i + b
Sy	= sd(y)				# Stichprobenvarianz von y
print(Sy)
Sy 	= a*Sx				# Stichprobenvarianz von y
print(Sy)

# a < 0
x 	= D$Pre.BDI      	# double Vektor der Pre-BDI Werte Werte
Sx	= sd(x)				# Stichprobenvarianz von x
a	= -3 				# Multiplikationskonstante
b 	= 10 				# Additionskonstante
y 	= a*x + b			# y_i = ax_i + b
Sy	= sd(y)				# Stichprobenvarianz von y
print(Sy)
Sy  = (-a)*Sx			# Stichprobenvarianz von y
print(Sy)
```

# 
\large
\vfill
\setstretch{2.5}

Spannbreite

Stichprobenvarianz

Stichprobenstandardabweichung

**Selbstkontrollfragen**
\vfill

# Selbstkontrollfragen

\footnotesize
\setstretch{1.6}
\begin{enumerate}
\justifying
\item Geben Sie die Definition der Spannbreite eines Datensatzes wieder.
\item Berechnen Sie die Spannbreite der Post.BDI Daten.
\item Geben Sie die Definition der Stichprobenvarianz und der empirischen Stichprobenvarianz wieder.
\item Berechnen Sie die Stichprobenvarianz und die empirische Stichprobenvarianz der Post.BDI Daten.
\item Geben Sie das Theorem zur Stichprobenvarianz bei linear-affinen Transformationen wieder.
\item Geben Sie den Verschiebungssatz zur empirischen Stichprobenvarianz wieder.
\item Geben Sie die Definition der Stichprobenstandardabweichung und der empirischen Stichprobenstandardabweichung wieder.
\item Berechnen Sie die Stichprobenstandardabweichung und die empirische Stichprobenstandardabweichung der Post.BDI Daten.
\item Geben Sie das Theorem zur Stichprobenstandardabweichung  bei linear-affinen Transformationen wieder.
\end{enumerate}
